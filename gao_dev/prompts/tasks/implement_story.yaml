name: implement_story
description: "Task prompt for story implementation by Bob and Amelia"
version: 2.0.0

user_prompt: |
  Execute the complete story implementation workflow for Story {{epic}}.{{story}}.

  ### Accessing Context via AgentContextAPI

  Before coordinating agents, set up the WorkflowContext and AgentContextAPI:

  ```python
  from gao_dev.core.context.context_api import set_workflow_context, get_workflow_context, AgentContextAPI
  from gao_dev.core.context.workflow_context import WorkflowContext
  import uuid

  # Create and set WorkflowContext
  context = WorkflowContext(
      workflow_id=str(uuid.uuid4()),
      epic_num={{epic}},
      story_num={{story}},
      feature="{{feature}}",
      workflow_name="implement_story"
  )
  set_workflow_context(context)

  # Initialize AgentContextAPI for document access
  api = AgentContextAPI(context)

  # Access documents (lazy-loaded, cached, tracked)
  epic_def = api.get_epic_definition()
  architecture = api.get_architecture()
  story_def = api.get_story_definition()
  coding_standards = api.get_coding_standards()
  ```

  Story Requirements:
  @doc:stories/epic-{{epic}}/story-{{epic}}.{{story}}.md

  Acceptance Criteria:
  @doc:stories/epic-{{epic}}/story-{{epic}}.{{story}}.md#acceptance-criteria

  Epic Context:
  @context:epic_definition

  Architecture Guidelines:
  @context:architecture

  Coding Standards:
  @context:coding_standards

  Quality Checklists:
  @checklist:testing/unit-test-standards
  @checklist:code-quality/solid-principles

  Coordinate the following agents:

  1. **Bob** (Scrum Master):
     - Verify story {{epic}}.{{story}} exists and is ready
     - Check story status

  2. **Amelia** (Developer):
     - Read the story requirements and acceptance criteria above
     - Create feature branch: feature/epic-{{epic}}-story-{{story}}
     - Use 'dev-story' workflow for implementation guidance
     - Follow coding standards and quality checklists
     - Implement all acceptance criteria
     - Write tests according to unit test standards
     - Update story status to 'In Progress'
     - Commit implementation

  3. **Amelia** (Code Review):
     - Review code quality against SOLID principles
     - Ensure tests pass
     - Verify acceptance criteria met
     - Update status to 'Ready for Review'

  4. **Bob** (Story Completion):
     - Verify all DoD items completed
     - Merge feature branch
     - Update story status to 'Done'
     - Create final commit

  Report progress at each step.

variables:
  epic: "1"
  story: "1"
  agent: "Bob"
  feature: ""

response:
  max_tokens: 8000
  temperature: 0.7

metadata:
  category: task
  phase: implementation
  agent: Bob

meta_prompts:
  enabled: true
