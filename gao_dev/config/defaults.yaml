# Default GAO-Dev Configuration

# ============================================================================
# Workflow Variable Defaults
# ============================================================================
# These defaults provide sensible out-of-the-box values for workflow variables.
# Workflows will use these defaults when variables are not provided via parameters
# or defined in workflow.yaml files.
#
# Priority order for variable resolution:
#   1. Parameters (passed to execute method)
#   2. Workflow.yaml variables section
#   3. Config defaults (this section)
#   4. Common variables (date, timestamp)
#
# Projects can override these defaults by creating a local gao-dev.yaml file
# with a workflow_defaults section.

workflow_defaults:
  # ========================================================================
  # FEATURE-BASED DOCUMENT STRUCTURE (v3.0)
  # ========================================================================
  # All paths now feature-scoped using co-located epic-story structure.
  # Epic folders contain their stories for intuitive navigation.
  #
  # Naming Convention:
  #   _location = specific file path (PRD.md, story-1.1.md)
  #   _folder   = directory path (epics/, QA/)
  #   _overview = master/index file (EPICS.md)
  #
  # Template Variables:
  #   {{feature_name}} = Feature name (e.g., "user-auth", "mvp")
  #   {{epic}}         = Epic number (e.g., "1", "2")
  #   {{epic_name}}    = Epic name (e.g., "foundation", "oauth")
  #   {{story}}        = Story number (e.g., "1", "2")
  # ========================================================================

  # ------------------------------------------------------------------------
  # Feature-Level Documents
  # ------------------------------------------------------------------------
  # Primary documents at feature root
  # ------------------------------------------------------------------------

  feature_dir: "docs/features/{{feature_name}}"
  prd_location: "docs/features/{{feature_name}}/PRD.md"
  architecture_location: "docs/features/{{feature_name}}/ARCHITECTURE.md"
  readme_location: "docs/features/{{feature_name}}/README.md"
  epics_overview: "docs/features/{{feature_name}}/EPICS.md"

  # ------------------------------------------------------------------------
  # Feature-Level Folders
  # ------------------------------------------------------------------------
  # Organizational folders at feature root
  # ------------------------------------------------------------------------

  qa_folder: "docs/features/{{feature_name}}/QA"
  retrospectives_folder: "docs/features/{{feature_name}}/retrospectives"
  ceremonies_folder: "docs/features/{{feature_name}}/ceremonies"
  standups_folder: "docs/features/{{feature_name}}/standups"

  # ------------------------------------------------------------------------
  # Epic-Level Paths (CO-LOCATED with stories!)
  # ------------------------------------------------------------------------
  # Epic folders contain:
  #   - README.md (epic definition)
  #   - stories/ (all stories for this epic)
  #   - context/ (context XML files)
  # ------------------------------------------------------------------------

  epic_folder: "docs/features/{{feature_name}}/epics/{{epic}}-{{epic_name}}"
  epic_location: "docs/features/{{feature_name}}/epics/{{epic}}-{{epic_name}}/README.md"

  # ------------------------------------------------------------------------
  # Story-Level Paths (INSIDE epic folder!)
  # ------------------------------------------------------------------------
  # Stories are co-located with their epic for intuitive navigation
  # ------------------------------------------------------------------------

  story_folder: "docs/features/{{feature_name}}/epics/{{epic}}-{{epic_name}}/stories"
  story_location: "docs/features/{{feature_name}}/epics/{{epic}}-{{epic_name}}/stories/story-{{epic}}.{{story}}.md"
  context_xml_folder: "docs/features/{{feature_name}}/epics/{{epic}}-{{epic_name}}/context"
  context_xml_location: "docs/features/{{feature_name}}/epics/{{epic}}-{{epic_name}}/context/story-{{epic}}.{{story}}.xml"

  # ------------------------------------------------------------------------
  # Ceremony Artifact Paths
  # ------------------------------------------------------------------------
  # Ceremony outputs stored at feature level
  # ------------------------------------------------------------------------

  retrospective_location: "docs/features/{{feature_name}}/retrospectives/epic-{{epic}}-retro.md"
  standup_location: "docs/features/{{feature_name}}/standups/standup-{{date}}.md"
  planning_session_location: "docs/features/{{feature_name}}/ceremonies/planning-{{date}}.md"

  # ------------------------------------------------------------------------
  # QA Artifact Paths
  # ------------------------------------------------------------------------
  # Quality assurance documents in QA/ folder
  # ------------------------------------------------------------------------

  qa_validation_location: "docs/features/{{feature_name}}/QA/QA_VALIDATION_EPIC_{{epic}}.md"
  test_report_location: "docs/features/{{feature_name}}/QA/TEST_REPORT_EPIC_{{epic}}.md"
  final_qa_report_location: "docs/features/{{feature_name}}/QA/FINAL_QA_REPORT_{{feature_name}}.md"

  # ------------------------------------------------------------------------
  # LEGACY PATHS (Backward Compatibility - DEPRECATED)
  # ------------------------------------------------------------------------
  # These paths are deprecated but kept for backward compatibility.
  # New workflows should use feature-scoped paths above.
  # Will be removed in future version.
  # ------------------------------------------------------------------------

  legacy_prd_location: "docs/PRD.md"
  legacy_architecture_location: "docs/ARCHITECTURE.md"
  legacy_tech_spec_location: "docs/TECHNICAL_SPEC.md"
  legacy_epic_location: "docs/epics.md"
  legacy_story_folder: "docs/stories"
  legacy_context_xml_folder: "docs/stories/{epic}/context"
  legacy_output_folder: "docs"
  legacy_sprint_status_location: "docs/sprint-status.yaml"
  legacy_workflow_status_location: "docs/bmm-workflow-status.md"

  # ------------------------------------------------------------------------
  # Common Variables (Auto-Generated)
  # ------------------------------------------------------------------------
  # These are auto-populated by WorkflowExecutor
  # ------------------------------------------------------------------------

  date: "{{date}}"                    # Current date (YYYY-MM-DD)
  timestamp: "{{timestamp}}"          # Current timestamp (ISO 8601)
  project_name: "{{project_name}}"    # Project name (from project_root)
  project_root: "{{project_root}}"    # Absolute path to project root
  agent: "{{agent}}"                  # Agent executing workflow
  workflow: "{{workflow}}"            # Workflow name

# ============================================================================
# Document Lifecycle Configuration
# ============================================================================
# Configuration for document lifecycle management and tracking.

document_lifecycle:
  # Directory for archived documents
  archive_dir: ".archive"

  # Automatically register workflow artifacts
  auto_register: true

  # Directory for document lifecycle database
  lifecycle_dir: ".gao-dev"

# ============================================================================
# Project Structure (Legacy - Deprecated)
# ============================================================================
# These top-level config values are deprecated. Use workflow_defaults instead.
# Kept for backward compatibility.

output_folder: "docs"
dev_story_location: "docs/stories"
context_xml_folder: "docs/stories/{epic}/context"
architecture_location: "docs/architecture.md"
prd_location: "docs/PRD.md"
epics_location: "docs/epics.md"

# Git Settings
git_auto_commit: true
git_branch_prefix: "feature/epic"
git_commit_footer: |

  ðŸ¤– Generated with GAO-Dev
  Co-Authored-By: Claude <noreply@anthropic.com>

# Quality Settings
qa_enabled: true
test_coverage_threshold: 80
type_safety_required: true

# Workflow Settings
workflow_validation: true
phase_gates_enabled: true
story_approval_required: true

# Logging
log_level: "INFO"
log_format: "json"

# Claude Settings
claude_model: "claude-sonnet-4"
claude_max_tokens: 8000

# Feature Flags
features:
  # Provider abstraction system (Epic 11)
  # Set to true after Phase 1 validation complete
  provider_abstraction_enabled: false

  # Ceremony integration (Epic 28)
  # Automatically inject ceremonies into workflow sequences
  enable_ceremony_integration: true

  # Interactive provider selection (Epic 35)
  # Enable interactive provider selection prompts at REPL startup
  # Set to false to use hardcoded defaults (rollback capability)
  # TEMPORARY: Disabled due to asyncio/prompt_toolkit conflict on Windows
  # TODO: Fix nested event loop issue (asyncio.run() conflict)
  interactive_provider_selection: false

# Provider Configuration (Epic 11)
providers:
  # Default provider for all agents (can be overridden per-agent)
  default: "claude-code"

  # Auto-detection settings
  auto_detect: true
  auto_fallback: true

  # Fallback chain if primary provider fails
  fallback_chain:
    - "claude-code"
    - "opencode"
    - "direct-api"

  # Selection strategy: "auto", "performance", "cost", "availability", "composite"
  selection:
    strategy: "auto"

    # Composite strategy weights (if strategy: "composite")
    composite_weights:
      performance: 0.6
      cost: 0.3
      availability: 0.1

    # Performance tracker settings
    performance:
      enabled: true
      cache_duration: 3600  # 1 hour

    # Health check settings
    health:
      enabled: true
      cache_duration: 300   # 5 minutes
      check_interval: 60    # Check every minute

  # Provider-specific configuration
  claude-code:
    cli_path: null  # Auto-detect if null
    api_key_env: "ANTHROPIC_API_KEY"
    default_model: "sonnet-4.5"
    timeout: 3600

  opencode:
    cli_path: null  # Auto-detect if null
    ai_provider: "anthropic"  # anthropic, openai, google
    api_key_env: "ANTHROPIC_API_KEY"
    default_model: "sonnet-4.5"
    timeout: 3600

  direct-api:
    provider: "anthropic"  # anthropic, openai, google
    api_key_env: "ANTHROPIC_API_KEY"
    base_url: null  # Optional override
    default_model: "sonnet-4.5"
    timeout: 3600
    max_retries: 3
    retry_delay: 1.0

# Model Name Registry
# Defines canonical model names and their provider-specific translations
models:
  registry:
    # Claude models
    - canonical: "sonnet-4.5"
      description: "Claude Sonnet 4.5 (Latest, most capable)"
      providers:
        claude-code: "claude-sonnet-4-5-20250929"
        opencode: "anthropic/claude-sonnet-4.5"
        direct-api: "claude-sonnet-4-5-20250929"

    - canonical: "sonnet-3.5"
      description: "Claude Sonnet 3.5"
      providers:
        claude-code: "claude-sonnet-3-5-20241022"
        opencode: "anthropic/claude-sonnet-3.5"
        direct-api: "claude-sonnet-3-5-20241022"

    - canonical: "opus-3"
      description: "Claude Opus 3 (Most capable, expensive)"
      providers:
        claude-code: "claude-opus-3-20250219"
        opencode: "anthropic/claude-opus-3"
        direct-api: "claude-opus-3-20250219"

    - canonical: "haiku-3"
      description: "Claude Haiku 3 (Fast, cost-effective)"
      providers:
        claude-code: "claude-haiku-3-20250219"
        opencode: "anthropic/claude-haiku-3"
        direct-api: "claude-haiku-3-20250219"

    # OpenAI models (OpenCode and Direct API only)
    - canonical: "gpt-4"
      description: "OpenAI GPT-4"
      providers:
        opencode: "openai/gpt-4"
        direct-api: "gpt-4-0125-preview"

    - canonical: "gpt-4-turbo"
      description: "OpenAI GPT-4 Turbo"
      providers:
        opencode: "openai/gpt-4-turbo-preview"
        direct-api: "gpt-4-turbo-preview"

    # Google models (OpenCode and Direct API only)
    - canonical: "gemini-pro"
      description: "Google Gemini Pro"
      providers:
        opencode: "google/gemini-pro"
        direct-api: "models/gemini-pro"

# Plugin Settings
plugins:
  enabled: true
  auto_discover: true
  directories:
    - ./plugins
    - ~/.gao-dev/plugins
  security:
    sandboxing: true
    allowed_modules: []
