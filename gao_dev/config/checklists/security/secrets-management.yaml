# Secrets Management Checklist
#
# This checklist verifies proper handling of secrets and credentials.
# Use during code review and security audit.

checklist:
  name: "Secrets Management"
  category: "security"
  version: "1.0.0"
  description: "Best practices for managing secrets and credentials"

  items:
    - id: "no-secrets-in-code"
      text: "No secrets hardcoded in source code"
      severity: "critical"
      help_text: "Never commit passwords, API keys, tokens, or certificates to source code. Use environment variables or secret management systems."
      references:
        - "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"

    - id: "no-secrets-in-vcs"
      text: "No secrets in version control history (.env files in .gitignore)"
      severity: "critical"
      help_text: "Add .env, credentials.json, and other secret files to .gitignore. Use git-secrets or similar tools to prevent commits."

    - id: "environment-variables"
      text: "Secrets loaded from environment variables or secret management system"
      severity: "high"
      help_text: "Use os.environ or python-dotenv for development. Use AWS Secrets Manager, HashiCorp Vault, or similar for production."

    - id: "secret-rotation"
      text: "Secrets can be rotated without code changes"
      severity: "medium"
      help_text: "Design systems to support secret rotation. Use key management services. Rotate secrets regularly."

    - id: "least-privilege"
      text: "Credentials follow principle of least privilege"
      severity: "high"
      help_text: "Grant minimum permissions required. Use separate credentials for different environments. Rotate credentials after employee departures."

    - id: "secret-logging"
      text: "Secrets are not logged or printed"
      severity: "critical"
      help_text: "Redact secrets in logs. Never print API keys or passwords. Use structured logging with secret filtering."

    - id: "secure-transmission"
      text: "Secrets are transmitted securely (HTTPS, encrypted channels)"
      severity: "high"
      help_text: "Never send secrets over plain HTTP or unencrypted protocols. Use TLS/SSL for all communication."

    - id: "secret-encryption"
      text: "Secrets at rest are encrypted"
      severity: "high"
      help_text: "Encrypt database fields containing secrets. Use AWS KMS, Azure Key Vault, or similar for encryption keys."

  metadata:
    domain: "software-engineering"
    applicable_to: ["code-review", "security-audit", "deployment"]
    author: "Winston"
    tags: ["security", "secrets", "credentials", "compliance"]
